---
title: "让 OpenClaw 记住一切：轻量级多 Agent 协作 + 自动记忆系统实战"
date: 2026-02-28
tags:
  - OpenClaw
  - 多Agent
  - 记忆系统
  - Swarm
category: AI技术
source: X
---

## 核心理念

玩 OpenClaw 要发挥最大功效，需要：
1. **多模型协作** - 不同模型做不同擅长的事
   - Claude Code：做规划
   - GPT5.3：写代码
   - 国产模型 (Minimax/Deepseek/GLM)：做消耗大的底层活
2. **轻量化** - 所有数据文本化

---

## 多 Agent 协作 (Swarm)

来自 OpenAI 2024 年的实验性框架，核心机制：
- **Handoffs** - Agent 之间交接
- **Routines** - 结构化多步骤流程

### 继承
- 多 Agent 流水线协作
- 分工明确
- 交接传递

### 强化
- 向量记忆
- 任务队列
- 自动学习
- 意图识别
- 错误重试

---

## 核心功能

### 1. 动态任务分解与路由
模糊指令 → 拆解成多个子任务 → 派给最合适的 Agent

### 2. 多轮辩论与共识达成
代理们有"思考"和"观点"，相互质询、补充论据，最终收敛到最优共识

### 3. 并行处理与实时容错
- 多个子任务并行执行
- 错误时自动重新路由

### 4. 意图识别
自动判断任务类型，匹配最佳工作流

### 5. 自动学习
记录每次任务的 Agent 组合和成功率，优化推荐策略

### 6. 任务队列
唯一 ID，状态全程追踪：pending → running → completed/failed

### 7. 错误重试
连续失败才判定为失败

### 8. 向量记忆
任务结果存入向量数据库，下次类似任务可检索历史经验

---

## 记忆系统设计

### 自动时间戳
Agent 执行任务后自动记录时间，解决：
- 时间戳自动化（不依赖 Agent 编码能力）
- 追加式写入（不覆盖已有内容）

### 知识验证（四分类）
写入知识文件前必须比对：
- **ADD** - 全新内容，直接追加
- **UPDATE** - 新版本替代旧版本
- **NOOP** - 内容已存在或高度相似，跳过
- **CONFLICT** - 矛盾信息，标记待人工裁决

### 路由规则
| 条件 | 目标 |
|------|------|
| 重大决策？ | decisions/ |
| 可复用经验？ | lessons/ |
| 关于某人的信息？ | people/ |
| 值得记录？ | 当天日志 |
| 无实质内容？ | 不写 |

---

## 三级检索

1. **扫描导航文件** - 定位目标文件
2. **直接读取目标文件** - 已知具体路径
3. **语义搜索** - 模糊查询（兜底）

---

## 遗忘机制

### 温度模型
- 时间衰减
- 被引用次数
- 优先级权重

### 自动归档
- 过期日志 → 归档
- 过期反思 → 归档
- 核心决策/经验/重要人物 → 永不归档

---

## 效果

运行 30 天后：
- ✅ Agent 不再重复问同样问题
- ✅ 跨任务知识可复用
- ✅ 新 Agent 上手快
- ✅ 系统仍然高效

---

## 参考项目

- Swarm 框架：OpenAI 2024
- 记忆系统参考：https://github.com/toby-bridges/epro-memory
- SwarmMemory：https://github.com/rebootmindful/SwarmMemory

---

*来源：X @龙爪槐*
